steps:
  # see https://www.npmjs.com/package/editorconfig-checker
  - id: eclint
    name: "e53e225/editorconfig-checker"

  - id: go_version
    name: "gcr.io/cloud-builders/go"
    args: [ "version" ]
    env: [ "GOPATH=." ]

  - id: go_linter
    name: "golangci/golangci-lint"
    args: [ "golangci-lint","run" ]

  - id: go_test
    name: "gcr.io/cloud-builders/go"
    args: [ "test","src" ]
    env: [ "GOPATH=." ]

  - id: go_security
    name: "securego/gosec"
    args: [ "src" ]
    env: [ "GOPATH=." ]

  - id: "Build da Imagem"
    name: "gcr.io/cloud-builders/docker"
    args: ["build", "-t", "gcr.io/$PROJECT_ID/ci-golang-tdd:$SHORT_SHA", "-f", "./.docker/Dockerfile", "."]

  - id: "Push da Imagem"
    name: "gcr.io/cloud-builders/docker"
    args: [ "push", "gcr.io/$PROJECT_ID/ci-golang-tdd:$SHORT_SHA" ]
